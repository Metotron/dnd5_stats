<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { getRandomValues } from '@/misc/randomValues'
import { useStatsStore } from '@/stores/stats'

import ValueLink from '@/components/ValueLink.vue'

// –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
const randomValues = ref<number[]>([])

const statsStore = useStatsStore()
onMounted(() => {
	// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
	generateRandomValues()
})

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ —Å–±—Ä–æ—Å –∏–º–µ—é—â–∏—Ö—Å—è –ø—Ä–∏–≤—è–∑–æ–∫
function generateRandomValues(): void {
	randomValues.value = getRandomValues()

	resetStatLinks()
}

// –°–±—Ä–æ—Å –ø—Ä–∏–≤—è–∑–∫–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫ –∏—Å—Ö–æ–¥–Ω—ã–º —á–∏—Å–ª–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º
function resetStatLinks(): void {
	// –í—ã–∑—ã–≤–∞–µ–º –Ω–∞ window —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥—É—Ç —Å–ª—É—à–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ValueLink, —á—Ç–æ–±—ã —Å–±—Ä–æ—Å–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–≤–æ–∏—Ö —Å–µ–ª–µ–∫—Ç–æ–≤
	window.dispatchEvent(new Event('ResetStatsStore'))
}
</script>


<template lang="pug">
.pageBlock.charStats
	.blockTitle
		slot
	.blockBody
		input(type="button" value="üîß –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å" @click="generateRandomValues")
		.valuesToStats
			value-link(
				v-for="(value, idx) in randomValues"
				:value="value"
				:value-index="idx"
				:key="idx"
			)
		input(type="button" value="üìù –ü—Ä–∏–≤—è–∑–∞—Ç—å" :disabled="!statsStore.isAllFieldsLinked")
</template>


<style lang="scss" scoped>
input[type="button"]:not([disabled]) {
	cursor: pointer;
}

.valuesToStats {
	margin-bottom: 1em;
}
</style>
